<!DOCTYPE html>
            <html lang="es">
                <!--
                    ██████╗ ██╗   ██╗████████╗ █████╗   ██╗ ██████╗ ██████╗
                    ██╔══██╗██║   ██║╚══██╔══╝██╔══██╗ ███║██╔═████╗╚════██╗
                    ██████╔╝██║   ██║   ██║   ███████║ ╚██║██║██╔██║ █████╔╝
                    ██╔══██╗██║   ██║   ██║   ██╔══██║  ██║████╔╝██║██╔═══╝
                    ██║  ██║╚██████╔╝   ██║   ██║  ██║  ██║╚██████╔╝███████╗
                    ╚═╝  ╚═╝ ╚═════╝    ╚═╝   ╚═╝  ╚═╝  ╚═╝ ╚═════╝ ╚══════╝ ®
                    Tus noticias 1337 H4x0r del año 2077.
                -->
                <head>
                    <meta charset="utf-8" />
                    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
                    <link rel="shortcut icon" href="/assets/img/favicon-32x32.png" type="image/png" />
                    <link rel="icon" href="/assets/img/favicon-32x32.png" type="image/png" />

                    <title>Ruta102 - Vulnerabilidad cr&#237;tica en sistemas de respaldos de energ&#237;a UPS de APC &#40;CVE-2022-22806&#41;</title>
                    <meta name="theme-color" content="#4d4948" />
                    <meta name="description" content="Noticias tecnol&oacute;gicas" />
                    <link rel="alternate" type="application/rss+xml" title="Ruta102" href="/rss.xml" />

                    <link rel="preconnect" href="https://fonts.googleapis.com" />
                    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
                    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&family=Lobster&display=swap" rel="stylesheet" />

                    <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
                    <link href="/assets/css/font-awesome.min.css" rel="stylesheet" />
                    <link href="/assets/css/style.css" rel="stylesheet" />

                    <script src="/assets/js/bootstrap.min.js"></script>
                </head>
                <body>
                    <div class="container mb-4">
                        <header class="border-bottom py-3 text-center">
                            <a class="text-decoration-none logo display-1 fw-normal" href="/">Ruta102</a>
                        </header>
                        <div class="nav-scroller py-1">
                            <nav class="nav d-flex justify-content-between pb-0">
                                
                                    <a class="p-2 text-decoration-none" href="/articulos/bug-bounty/">
                                        Bug bounty
                                    </a>
                                
                                    <a class="p-2 text-decoration-none" href="/articulos/filtraciones/">
                                        Filtraciones
                                    </a>
                                
                                    <a class="p-2 text-decoration-none" href="/articulos/vulnerabilidades/">
                                        Vulnerabilidades
                                    </a>
                                
                            </nav>
                        </div>
                    </div>
                    <main role="main" class="container component-article">
                        
                            <div class="mb-4 mt-3">
                                <h1>
                                    <a href="/articulos/vulnerabilidades/2022/03/13/vulnerabilidad-critica-cre-ups-apc/">Vulnerabilidad cr&#237;tica en sistemas de respaldos de energ&#237;a UPS de APC &#40;CVE-2022-22806&#41;</a>
                                </h1>
                                
                                    <p class="text-muted">
                                        13 de marzo de 2022 por
                                        <a href="https://www.linkedin.com/in/yhojann-aguilera/" target="_blank">Yhojann Aguilera Aguayo</a>
                                        en
                                        <a href="/articulos/vulnerabilidades/">Vulnerabilidades</a>.
                                    </p>
                                
                            </div>
                        

                        <div>
                            
                                <img
                                    title="Vulnerabilidad crítica en sistemas de respaldos de energía UPS de APC (CVE-2022-22806)"
                                    alt="img"
                                    class="d-none d-md-inline float-start me-3 mb-3 img-thumbnail"
                                    style="width: 200px; height: 250px;"
                                    src="/assets/img/vendors/ups-apc.png" />
                            
                            <h3 id="resumen">Resumen</h3>
<p>En Chile existe la gran preocupación entre distintas empresas,
debido a una serie de vulnerabilidades en equipos UPS de
respaldo de energía que podría poner en jaque el suministro
eléctrico y sus equipos conectados.</p>
<p>Se ha publicado recientemente diversos problemas en los sistemas
UPS de protección de energía de la empresa APC los cuales pueden
comprometer el sistema de suministro en una empresa. Lo más
preocupante es que esta vulnerabilidad puede ser aprovechada de
manera remota y <strong>puede provocar un daño físico a los
equipos</strong>.</p>
<p>Este grupo de vulnerabilidades ha sido llamada TLStorm y se ha
catalogado por los expertos como una de las vulnerabilidades más
preocupantes de lo que va del año.</p>
<p>Cabe mencionar que estos equipos de protección de energía son
componentes críticos para distintas infraestructuras, tales como
de gobierno, salud, seguridad física en general, centros de
datos y similares.</p>
<h3 id="elriesgo">El riesgo</h3>
<p>A continuación, se desglosa el riesgo por cada vulnerabilidad:</p>
<ul>
<li><strong>CVE-2022-22806</strong> de severidad crítica, con una puntuación CVSS3 9.0. Esta vulnerabilidad se debe a errores de la biblioteca nanoSSL, provocando un problema de estado en el protocolo de enlace TLS, omitiendo la autenticación de este (TLS), con lo cual permitiría a un atacante remoto no autenticado la ejecución remota de código (RCE).</li>
<li><strong>CVE-2022-22805</strong> de severidad crítica, con una puntuación CVSS3 9.0. Esta vulnerabilidad se debe a errores de la biblioteca nanoSSL, provocando un error de corrupción de memoria en el reensamblaje de paquetes. Un atacante remoto no autenticado podría aprovechar el error de biblioteca nanoSSL y realizar ejecución remota de código (RCE).</li>
<li><strong>CVE-2022-0715</strong> de severidad crítica, con una puntuación CVSS 9.0. Esta vulnerabilidad se debe a una falla de diseño, en la que las actualizaciones de firmware en los dispositivos afectados no se firman criptográficamente de manera segura. Un atacante podría aprovechar esta vulnerabilidad y crear firmware malintencionado e instalarlo mediante varias rutas, como Internet, LAN o una unidad USB, provocando la ejecución remota de código (RCE).</li>
</ul>
<h3 id="algunasfuentes">Algunas fuentes</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22806" rel="noopener noreferrer" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2022-22806</a></li>
<li><a href="https://www.cert.gov.py/noticias/vulnerabilidades-criticas-en-los-dispositivos-smart-ups-de-apc" rel="noopener noreferrer" target="_blank">https://www.cert.gov.py/noticias/vulnerabilidades-criticas-en-los-dispositivos-smart-ups-de-apc</a></li>
<li><a href="https://www.armis.com/research/tlstorm/" rel="noopener noreferrer" target="_blank">https://www.armis.com/research/tlstorm/</a></li>
<li><a href="https://underc0de.org/foro/noticias-informaticas-120/los-errores-de-dia-cero-de-apc-ups-pueden-quemar-dispositivos-de-forma-remota/" rel="noopener noreferrer" target="_blank">https://underc0de.org/foro/noticias-informaticas-120/los-errores-de-dia-cero-de-apc-ups-pueden-quemar-dispositivos-de-forma-remota/</a></li>
</ul>
<h3 id="anlisisdelimpacto">Análisis del impacto</h3>
<p>Según fuentes oficiales, el problema principal reside en la
<strong>implementación de SSL/TLS</strong>, un protocolo ámpliamente
utilizado para el resguardo de la comunicación entre servicios
bajo TCP, pero en este caso el componente afectado es la
funcionalidad de <strong>SmartConnect</strong> el cual se encarga de la
comunicación entre diferentes dispositivos de Smart-UPS.
Directamente hablando se trata de la <strong>ejecución de código
debido a la corrupción de memoria</strong> por a un desbbordamiento
no controlado.</p>
<p>Adicionalmente a este problema, también cuenta con otra
vulnerabilidad totalmente distinta la cual permite a un
delincuente informático a <strong>evadir el mecanismo de encriptado
del Firmware</strong> debido a que este carece de una llave
criptográfica.</p>
<p>Estas dos vulnerabilidades juntas <strong>pueden permitir a un atacante
dentro de la red local del equipo afectado, corromper la memoria
de estos equipos e instalar un nuevo firmware infectado</strong>.</p>
<p>Hay que recordar que estos equipos mantienen una conectividad de
manera física con los componentes electrónicos <strong>sin ningún
mecanismo de tipo Sandboxing o isolación</strong> que pudiesen
proteger al circuito eléctrico de posibles ataques vía Software
como si lo hace una placa madre de un computador, servidor o
dispositivo móvil. Esto abre la posibilidad de <strong>estropear
físicamente los componentes a traves del cambio de voltaje,
interrupciones y similares</strong>.</p>
<h3 id="recomendacionesalosusuarios">Recomendaciones a los usuarios</h3>
<p>Schneider Electric ha publicado recientemente
<a href="https://download.schneider-electric.com/files?p_Doc_Ref=SEVD-2022-067-02" rel="noopener noreferrer" target="_blank">una actualización de seguridad crítica</a>
que soluciona este problema, por lo cual se recomienda aplicar este parche lo
antes posible.</p>
<p><a href="https://www.armis.com/research/tlstorm/" rel="noopener noreferrer" target="_blank">El grupo de investigación Armis</a> que
ha encontrado este fallo y lo ha reportado oportunamente mencionan las
siguientes recomendaciones:</p>
<ul>
<li>Instale los parches disponibles en el sitio web de Schneider Electric.</li>
<li>Si está utilizando la NMC, cambie la contraseña predeterminada de la NMC ("apc") e instale un certificado SSL firmado públicamente para que un atacante en su red no pueda interceptar la nueva contraseña. Para limitar aún más la superficie de ataque de su NMC, consulte el Manual de seguridad de Schneider Electric para NMC2 y NMC3.</li>
<li>Implemente listas de control de acceso (ACL) en las que los dispositivos UPS solo pueden comunicarse con un pequeño conjunto de dispositivos de administración y Schneider Electric Cloud a través de comunicaciones cifradas.</li>
</ul>
                            <div class="clearfix"></div>

                            
                                <h3 class="mt-5">
                                    <b>
                                        <svg class="me-2" xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-megaphone-fill" viewBox="0 0 16 16">
                                            <path d="M13 2.5a1.5 1.5 0 0 1 3 0v11a1.5 1.5 0 0 1-3 0zm-1 .724c-2.067.95-4.539 1.481-7 1.656v6.237a25 25 0 0 1 1.088.085c2.053.204 4.038.668 5.912 1.56zm-8 7.841V4.934c-.68.027-1.399.043-2.008.053A2.02 2.02 0 0 0 0 7v2c0 1.106.896 1.996 1.994 2.009l.496.008a64 64 0 0 1 1.51.048m1.39 1.081q.428.032.85.078l.253 1.69a1 1 0 0 1-.983 1.187h-.548a1 1 0 0 1-.916-.599l-1.314-2.48a66 66 0 0 1 1.692.064q.491.026.966.06"/>
                                        </svg>
                                        &iquest;Deseas comentar este art&iacute;culo?
                                    </b>
                                </h3>
                                <p>
                                    &Uacute;nete a la conversaci&oacute;n en
                                    <a target="_blank" rel="noreferrer"
                                        href="https://t.me/ruta102">nuestro grupo de Telegram</a>
                                    y comparte tu opini&oacute;n. Tambien puedes compartirnos tus art&iacute;culos en nuestro
                                    <a target="_blank" rel="noreferrer"
                                        href="https://github.com/yhojann-cl/ruta102.cl/issues/new/choose">repositorio p&uacute;blico</a>.
                                </p>
                            
                        </div>
                    </main>
                    <footer class="py-5">
                        <div class="container border-top pt-4 text-center">
                            <p>
                                Ruta102 es una editorial Chilena fundada en el
                                a&ntilde;o 2021, que tiene como objetivo
                                informar <b>de manera realista</b>
                                informaci&oacute;n tecnol&oacute;gica realmente
                                relevantes velando por el tiempo y la necesidad
                                de sus lectores. <a href="/acerca-de/">Leer
                                m&aacute;s</a>
                            </p>
                            <p>
                                <a
                                    class="btn btn-sm btn-outline-info align-items-center mx-1"
                                    href="/rss.xml" target="_blank">
                                    <svg class="me-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-rss" viewBox="0 0 16 16">
                                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                        <path d="M5.5 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-3-8.5a1 1 0 0 1 1-1c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1-1-1zm0 4a1 1 0 0 1 1-1 6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1-1-1z"/>
                                    </svg>
                                    RSS
                                </a>
                                <a
                                    target="_blank"
                                    rel="noreferrer"
                                    class="btn btn-sm btn-outline-info align-items-center mx-1"
                                    href="https://t.me/ruta102">
                                    <svg class="me-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-telegram" viewBox="0 0 16 16">
                                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.287 5.906q-1.168.486-4.666 2.01-.567.225-.595.442c-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294q.39.01.868-.32 3.269-2.206 3.374-2.23c.05-.012.12-.026.166.016s.042.12.037.141c-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8 8 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629q.14.092.27.187c.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.4 1.4 0 0 0-.013-.315.34.34 0 0 0-.114-.217.53.53 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09"/>
                                    </svg>
                                    Telegram
                                </a>
                                <a
                                    target="_blank"
                                    rel="noreferrer"
                                    class="btn btn-sm btn-outline-info align-items-center mx-1"
                                    href="https://play.google.com/store/apps/details?id=com.google.android.apps.magazines">
                                    <svg class="me-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-google-play" viewBox="0 0 16 16">
                                        <path d="M14.222 9.374c1.037-.61 1.037-2.137 0-2.748L11.528 5.04 8.32 8l3.207 2.96 2.694-1.586Zm-3.595 2.116L7.583 8.68 1.03 14.73c.201 1.029 1.36 1.61 2.303 1.055l7.294-4.295ZM1 13.396V2.603L6.846 8 1 13.396ZM1.03 1.27l6.553 6.05 3.044-2.81L3.333.215C2.39-.341 1.231.24 1.03 1.27Z"/>
                                    </svg>
                                    Google News
                                </a>
                                <a
                                    target="_blank"
                                    rel="noreferrer"
                                    class="btn btn-sm btn-outline-info align-items-center mx-1"
                                    href="https://github.com/yhojann-cl/ruta102.cl/issues">
                                    <svg class="me-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                                        <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
                                    </svg>
                                    Cont&aacute;ctanos
                                </a>
                            </p>
                        </div>
                    </footer>
                    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0C70VDSF4W"></script>
                    <script>
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){ dataLayer.push(arguments); }
                        gtag('js', new Date());
                        gtag('config', 'G-0C70VDSF4W');
                    </script>
                </body>
            </html>